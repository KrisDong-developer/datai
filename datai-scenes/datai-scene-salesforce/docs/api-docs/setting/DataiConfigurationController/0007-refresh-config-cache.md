# 接口文档

## 接口信息

- **接口名称**: 刷新配置缓存
- **接口路径**: /setting/configuration/refresh
- **请求方法**: POST
- **模块归属**: datai-salesforce-setting
- **版本号**: v1.0
- **创建日期**: 2026-01-14
- **最后更新**: 2026-01-14

## 功能描述

刷新配置缓存，清除系统中的配置缓存，重新从数据库加载配置数据。刷新缓存后，系统将使用最新的配置数据。建议在修改配置后刷新缓存，以确保系统使用最新的配置。

## 请求参数

无请求参数

## 响应数据

### 成功响应

**HTTP 状态码**: 200 OK

```json
{
  "code": 200,
  "msg": "配置缓存刷新成功",
  "data": null
}
```

| 字段名 | 类型 | 描述 | 示例 |
|--------|------|------|------|
| code | Integer | 响应码 | 200 |
| msg | String | 响应消息 | 配置缓存刷新成功 |
| data | Object | 响应数据 | null |

### 失败响应

**HTTP 状态码**: 400/401/403/500

```json
{
  "code": 500,
  "msg": "刷新失败",
  "data": null
}
```

| 错误码 | 错误信息 | 描述 |
|--------|----------|------|
| 400 | 参数错误 | 参数验证失败 |
| 401 | 您没有权限执行此操作 | 权限不足 |
| 403 | 访问被拒绝 | 访问被拒绝 |
| 500 | 刷新失败 | 系统错误 |

## 接口示例

### 请求示例

```bash
curl -X POST "http://localhost:8080/setting/configuration/refresh" \
  -H "Authorization: Bearer [token]"
```

### 响应示例

**成功**:

```json
{
  "code": 200,
  "msg": "配置缓存刷新成功",
  "data": null
}
```

**失败**:

```json
{
  "code": 500,
  "msg": "刷新失败",
  "data": null
}
```

## 错误处理

1. **权限验证失败**: 检查用户是否具有 setting:configuration:refresh 权限
2. **刷新失败**: 记录错误日志并返回通用错误信息

## 注意事项

1. 接口需要登录认证，需要携带有效的 token
2. 接口需要 setting:configuration:refresh 权限
3. 刷新操作会记录到操作日志中
4. 刷新缓存会清除系统中的配置缓存，重新从数据库加载配置数据
5. 刷新缓存后，系统将使用最新的配置数据
6. 建议在修改配置后刷新缓存，以确保系统使用最新的配置
7. 刷新缓存可能会影响系统性能，建议在低峰期执行
8. 刷新缓存可能会导致系统短暂不可用，请谨慎操作
9. 刷新缓存后，系统会重新加载所有配置数据，可能需要一定时间
10. 建议在刷新缓存前先查询配置缓存状态
11. 刷新缓存操作不可逆，请谨慎操作
12. 建议在刷新缓存前先创建备份

## 相关接口

- [查询配置列表](0001-configuration-list.md) - 查询配置列表
- [导出配置列表](0002-export-configuration-list.md) - 导出配置列表
- [获取配置详细信息](0003-get-info.md) - 获取单个配置的详细信息
- [新增配置](0004-add-configuration.md) - 新增配置
- [修改配置](0005-edit-configuration.md) - 修改配置
- [删除配置](0006-remove-configuration.md) - 删除配置
- [查询配置缓存状态](0008-get-config-cache-status.md) - 查询配置缓存状态

## 实现细节

1. 验证用户权限
2. 调用 IDataiConfigurationService 刷新配置缓存
3. 记录操作日志
4. 返回操作结果

## 测试信息

### 测试环境

- **环境**: 本地开发环境
- **版本**: v1.0

### 测试用例

| 测试场景 | 输入参数 | 预期结果 | 实际结果 | 状态 |
|----------|----------|----------|----------|------|
| 刷新配置缓存 | 无参数 | 刷新成功 | 刷新成功 | 通过 |
| 无权限访问 | 无权限token | 返回401错误 | 返回401错误 | 通过 |
