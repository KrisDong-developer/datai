# datai-scene-file 模块说明文档

## 模块概述

datai-scene-file 是 datai 项目中的文件管理场景模块，提供统一的文件存储、访问和管理能力。该模块采用抽象化设计，支持多种存储后端，包括本地文件系统、MinIO 分布式对象存储和阿里云 OSS 云存储服务，为上层应用提供灵活、可扩展的文件管理解决方案。

## 核心功能

### 多存储后端支持
- 统一的存储抽象层，支持无缝切换不同的存储实现
- 本地文件系统存储，适用于单机部署和开发环境
- MinIO 分布式对象存储，适用于私有云和分布式部署
- 阿里云 OSS 云存储，适用于公有云部署和大规模文件管理

### 文件全生命周期管理
- 文件上传：支持单文件上传和分块上传
- 文件下载：支持直接下载和预签名 URL 访问
- 文件删除：支持单个文件删除和批量删除
- 文件访问控制：支持公共访问和临时授权访问

### 文件元数据管理
- 文件信息记录：文件名、大小、类型、存储路径等基本信息
- 文件完整性校验：基于 MD5 的文件去重和完整性验证
- 文件分块信息：记录大文件分块上传的详细信息

## 主要作用

### 存储抽象层
- 定义统一的存储接口，隐藏不同存储后端的实现细节
- 提供一致的 API 调用方式，简化上层应用开发
- 支持运行时动态切换存储后端，提高系统灵活性

### 文件服务集成
- 提供 RESTful API 接口，方便前端应用和其他服务调用
- 支持多种文件操作场景，满足不同业务需求
- 集成文件访问权限控制，保障文件安全

## 关键特性

### 高性能文件处理
- 支持大文件分块上传，提高大文件传输可靠性
- 文件 MD5 校验，实现秒传功能，减少重复存储
- 多线程并发处理，提高文件操作效率

### 可扩展架构
- 模块化设计，各子模块职责清晰
- 插件式存储实现，易于扩展新的存储后端
- 配置驱动的存储选择，支持多存储并存

### 企业级特性
- 完善的异常处理机制，提高系统稳定性
- 详细的日志记录，便于问题排查和系统监控
- 灵活的配置选项，适应不同部署环境

## 模块组成

datai-scene-file 由以下子模块组成：

- datai-file-common：核心实体类、存储抽象接口和工具类
- datai-file-local：本地文件系统存储实现
- datai-file-minio：MinIO 分布式对象存储实现
- datai-file-aliyun-oss：阿里云 OSS 云存储实现
- datai-file-starter：文件服务 REST API 接口和自动配置

## 技术栈

- 核心框架：Spring Boot、Spring MVC
- 存储技术：本地文件系统、MinIO、阿里云 OSS
- 文件处理：Spring MultipartFile
- 构建工具：Maven

## 依赖管理

模块统一管理外部依赖版本：
- MinIO SDK：8.2.1
- 阿里云 OSS SDK：3.18.1

通过 dependencyManagement 统一管理子模块依赖，确保版本一致性。