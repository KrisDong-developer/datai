# datai-file-common 模块说明文档

## 模块概述

datai-file-common 是 datai-scene-file 场景的核心公共模块，为整个文件管理系统提供基础架构和通用功能。该模块定义了文件存储的抽象层、核心实体模型、服务接口和实用工具类，为不同存储实现提供统一的支持。

## 核心功能

### 1. 文件元数据管理
- 定义统一的文件信息实体模型，包含文件ID、名称、路径、存储类型、大小、MD5等关键属性
- 提供文件分片上传的ETag跟踪机制，支持大文件分片上传场景
- 实现文件信息的数据访问层，支持文件元数据的持久化操作

### 2. 存储抽象层
- 设计存储桶接口抽象，定义统一的存储操作规范
- 提供存储实体模型，封装不同存储系统的通用属性
- 实现存储工厂模式，支持多种存储类型的动态创建和管理

### 3. 文件操作服务
- 实现完整的文件上传、下载、删除等基础操作
- 支持基于MD5的快速上传机制，避免重复文件存储
- 提供文件分片上传功能，支持大文件处理
- 实现文件访问URL生成，包括公共URL和预签名URL

### 4. 工具类支持
- 提供文件操作工具类，简化常见文件处理任务
- 实现存储工具类，支持存储配置和操作辅助
- 集成文件类型验证、大小限制等安全检查机制

## 主要特性

### 1. 统一抽象
- 通过接口抽象实现存储系统的解耦，使上层业务逻辑与具体存储实现分离
- 定义标准化的文件操作接口，便于扩展新的存储类型

### 2. 性能优化
- 实现基于MD5的快速上传机制，通过缓存避免重复文件存储
- 支持分片上传，提高大文件传输的可靠性和效率

### 3. 多存储支持
- 设计灵活的存储架构，支持本地存储、MinIO对象存储和阿里云OSS等多种存储后端
- 提供统一的配置和管理机制，简化多存储系统的集成

### 4. 安全机制
- 集成文件类型白名单验证，防止恶意文件上传
- 实现文件大小限制，控制存储资源使用
- 支持预签名URL生成，提供安全的临时文件访问

## 模块定位

datai-file-common 作为文件管理场景的核心基础模块，为整个文件系统提供：
- 统一的数据模型和接口定义
- 通用的业务逻辑和服务实现
- 基础的工具类和辅助功能
- 存储抽象层，支持多种存储后端的无缝切换

该模块是构建文件存储、访问和管理功能的基础，为上层业务模块提供稳定、高效、可扩展的文件服务支持。