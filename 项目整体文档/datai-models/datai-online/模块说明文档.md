# datai-online 模块说明文档

## 1. 模块概述

datai-online 是在线开发模块，提供基于MyBatis的动态SQL执行和在线API接口管理功能。该模块实现了无需编写代码即可创建和管理API接口的能力，通过可视化配置SQL语句和接口参数，快速生成可用的RESTful API。模块支持动态SQL执行、数据库表结构查询、权限控制和参数处理等功能，为低代码开发和快速原型设计提供了强大支持。

## 2. 核心功能

| 功能类别 | 功能名称 | 功能描述 |
|---------|---------|---------|
| 在线API管理 | API接口配置 | 通过可视化界面配置API接口的路径、方法和SQL语句 |
| 在线API管理 | 动态SQL执行 | 支持在线编写和执行SQL语句，实现数据增删改查操作 |
| 在线API管理 | 接口权限控制 | 支持基于角色和权限的接口访问控制 |
| 在线API管理 | 参数自动处理 | 自动处理请求参数，支持多种参数格式和类型 |
| 数据库管理 | 表结构查询 | 查询数据库表列表和字段信息 |
| 数据库管理 | 列信息查询 | 获取指定表的列详细信息 |
| SQL工具 | SqlMapper工具 | 提供MyBatis动态SQL执行能力，支持多种SQL操作 |
| SQL工具 | SQL语句缓存 | 自动缓存SQL语句，提高执行效率 |
| 安全控制 | 权限验证 | 集成系统权限框架，支持细粒度权限控制 |
| 安全控制 | 用户上下文注入 | 自动注入当前用户ID和部门ID到SQL参数中 |

## 3. 模块架构

datai-online 模块采用分层架构设计，主要包含以下层次：

- **控制层(Controller)**: 提供RESTful API接口，处理在线API管理和数据库查询的HTTP请求
- **服务层(Service)**: 实现在线API管理的核心业务逻辑，包括API配置、SQL执行等
- **数据访问层(Mapper)**: 负责与数据库交互，实现API配置的持久化和数据库元数据查询
- **工具层(Util)**: 提供SQL执行所需的工具类，如SqlMapper等
- **领域模型层(Domain)**: 定义在线API管理相关的实体类，如OnlineMb等

## 4. 主要依赖

| 依赖名称 | 依赖说明 | 用途 |
|---------|---------|------|
| datai-common | 通用工具模块 | 提供基础工具类、常量和通用功能 |

## 5. 关键特性

1. **零代码API开发**: 通过可视化配置SQL语句和接口参数，无需编写代码即可创建API接口
2. **动态SQL执行**: 基于MyBatis实现动态SQL执行，支持复杂的查询条件和数据操作
3. **灵活的权限控制**: 支持多种权限验证方式，包括hasPermi、lacksPermi、hasAnyPermi、hasRole等
4. **参数自动处理**: 智能解析和处理请求参数，支持params格式和普通参数格式
5. **用户上下文注入**: 自动将当前用户ID和部门ID注入到SQL参数中，简化数据权限控制
6. **数据库元数据查询**: 提供数据库表结构和字段信息的查询功能，辅助API开发
7. **SQL语句缓存**: 自动缓存已执行的SQL语句，提高重复查询的性能
8. **多执行器支持**: 支持selectList、selectOne、insert、update、delete等多种SQL执行器

## 6. 模块总结

datai-online 作为在线开发模块，是DataI项目中实现低代码开发和快速API构建的核心组件。它通过提供可视化的API配置界面和强大的动态SQL执行能力，使开发者能够快速创建和管理API接口，无需编写传统的Controller、Service和Mapper代码。模块集成了完善的权限控制机制，确保API接口的安全性；支持参数自动处理和用户上下文注入，简化了开发过程。通过datai-online，开发团队可以快速构建原型、实现简单的数据接口，提高开发效率，降低技术门槛，特别适合快速迭代和需求变化频繁的项目场景。